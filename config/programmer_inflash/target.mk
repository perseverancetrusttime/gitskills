CHIP		?= best1501

DEBUG		?= 1

NOSTD		?= 1

LIBC_ROM	?= 1

PROGRAMMER	:= 1

FAULT_DUMP	?= 0

WATCHER_DOG ?= 1

init-y		:=
core-y		:= tests/programmer/ platform/cmsis/ platform/hal/
core-y      += tests/programmer_inflash/

LDS_FILE	:= programmer_inflash.lds

export CRC32_ROM ?= 1

KBUILD_CPPFLAGS += -Iplatform/cmsis/inc -Iplatform/hal

KBUILD_CPPFLAGS += -DPROGRAMMER_INFLASH \

KBUILD_CFLAGS +=

LIB_LDFLAGS +=

CFLAGS_IMAGE +=

LDFLAGS_IMAGE +=

ifeq ($(CHIP),best1501)
# enabled when 1501 flash remap is ready
export OTA_REBOOT_FLASH_REMAP ?= 0
else
export OTA_REBOOT_FLASH_REMAP ?= 0
endif

#NOTE(Mike.Cheng):Disable OTA BOOT FAST COPY here
#OTA_BOOT_FAST_COPY ?= 1
OTA_BOOT_FAST_COPY ?= 0  
ifeq ($(OTA_BOOT_FAST_COPY),1)
KBUILD_CPPFLAGS += -D_OTA_BOOT_FAST_COPY_ 
OSC_26M_X4_AUD2BB := 0
ULTRA_LOW_POWER := 0
endif
FLASH_SIZE ?= 0x400000

#NOTE(Mike.Cheng):Disable SECURE_BOOT_WORKAROUND_SOLUTIONY here
#export SECURE_BOOT_WORKAROUND_SOLUTION ?= 1
export SECURE_BOOT_WORKAROUND_SOLUTION ?= 0

ifeq ($(SECURE_BOOT_WORKAROUND_SOLUTION),1)
KBUILD_CPPFLAGS += -DSECURE_BOOT_WORKAROUND_SOLUTION
KBUILD_CPPFLAGS += -DOTA_BOOT_APP_BOOT_INFO_OFFSET=0x3f9000
KBUILD_CPPFLAGS += -DOTA_BOOT_FROM_APP_FLASH_NC
endif

#NOTE(Mike.Cheng):UART BUAD & APP BIN Flash Offset
KBUILD_CPPFLAGS += -DDOWNLOAD_UART_BANDRATE=921600
KBUILD_CPPFLAGS += -D__APP_IMAGE_FLASH_OFFSET__=0x18000
ifneq ($(filter best1501 best2001,$(CHIP)),)
	ifeq ($(XSPACE_PROJ),1)
	KBUILD_CPPFLAGS += -DAPP_ENTRY_ADDRESS=0x2c018000
	#KBUILD_CPPFLAGS += -D__APP_IMAGE_FLASH_OFFSET__=0x18000
	else
	KBUILD_CPPFLAGS += -DAPP_ENTRY_ADDRESS=0x2c018000
	#KBUILD_CPPFLAGS += -D__APP_IMAGE_FLASH_OFFSET__=0x10000
	endif
else
	ifneq ($(filter best1400 best2300 best2300p,$(CHIP)),)
	KBUILD_CPPFLAGS += -DAPP_ENTRY_ADDRESS=0x3c018000                   
	else
	KBUILD_CPPFLAGS += -DAPP_ENTRY_ADDRESS=0x3c018000 
	endif	
endif
				   
#export SINGLE_WIRE_DOWNLOAD ?= 1
#KBUILD_CPPFLAGS += -DUNCONDITIONAL_ENTER_SINGLE_WIRE_DOWNLOAD

export FLASH_UNIQUE_ID ?= 1
export TRACE_BAUD_RATE := 10*115200

ifeq ($(OTA_REBOOT_FLASH_REMAP),1)
KBUILD_CPPFLAGS += -DOTA_REBOOT_FLASH_REMAP
endif # REMAP
